### Logback 사용하기 

#### 특징

- 오랫동안 널리 사용되고 검증된 Log4j 를 기반으로 다시 작성됨.

- 로그 설정이 변경될 경우 서버를 재시작하지 않더라도 바로 반영됨.

- slf4j 를 함께 사용함. (자바의 다양한 로그 모듈들의 추상체)

- src/main/resources 폴더에 logback-spring.xml 파일 생성및 작성

- 사용하는 로그 레벨 

  | 로그레벨 | 설명                                                         |
  | -------- | ------------------------------------------------------------ |
  | trace    | 모든 로그를 출력함.                                          |
  | debug    | 개발시 디버그 용도로 사용.                                   |
  | info     | 상태 변경 등 정보성 메세지 나타냄.                           |
  | warn     | 프로그램의 실행에는 문제가 없지만 추후 시스템 에러의 원인이 될 수 있다는 경고성 메세지 의미함. |
  | error    | 요청을 처리하던 중 문제가 발생.                              |

- 로그를 사용하려는 클래스에서 로거 생성

  getlogger 메서드의 파라미터 : 로거의 이름 설정 

  `Logger log = LoggerFactory.getLogger(this.getClass());`



### Log4JDBC로 쿼리 로그 정렬하기 

- 앞에서 사용하는 로그들은 개발하는데 당장 필요하지 않은 정보가 많음. 또한 정렬되어 있지 않아 로그 한눈에 알아보기 힘듬. 
- 긴 쿼리들도 한줄에 나와서 한눈에 파악하기 힘들다. 
- 위와 같은 이유들로 Log4JDBC 라이브러리 사용함. 

#### 라이브러리 추가하기 

- build.gradle 파일에 추가 

#### log4jdbc 설정하기 

- log4jdbc.log4j2.properties 설정 
- application.properties 설정 
- logback-spring.xml 설정 : 쿼리 및 실행 결과를 보여주는 로거 추가 
  - sqlonly 와 resulttable 로거 사용 



### 인터셉터 사용하기

- 어떠한 URI를 호출했을 때 해당 요청의 컨트롤러가 처리되기 전 또는 후에 작업을 하기 위해서 사용됨.  --> 필터와 인터셉터가 이 역할을 수행 
- ![1563776524044](C:\Users\bsww201\AppData\Roaming\Typora\typora-user-images\1563776524044.png)

- 필터는 서블릿의 기능 중 일부.
- 인터셉터는 스프링 프레임워크에서 제공되는 기능. 스프링 Bean을 사용할 수 있음. 

#### HandlerInterceptorAdaptor로 인터셉터 구현하기 

- 스프링에서 인터셉터는 HandlerInterceptorAdaptor 클래스를 상속받아 구현. 

- | 메서드          | 역할                                             |
  | --------------- | ------------------------------------------------ |
  | preHandle       | 컨트롤러 실행전에 수행됨.                        |
  | postHandle      | 컨트롤러 실행 후 결과를 뷰로 보내기 전에 수행됨. |
  | afterCompletion | 뷰의 작업까지 완료된 후 수행됨.                  |



#### Interceptor 등록하기 

- 스프링 빈으로 등록하기 